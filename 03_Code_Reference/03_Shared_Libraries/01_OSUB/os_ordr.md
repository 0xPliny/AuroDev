# os_ordr - MHC_ORDER Table Operations

**Document Version:** 1.0  
**Last Updated:** 2024-12-23  
**Author:** CmL  
**Confidence Score:** 0.95

---

## Document Metadata

| Field | Value |
|-------|-------|
| **Source File** | `os_ordr.cpp`, `os_ordr.h` |
| **Generated From** | `MHC_ORDER` table definition in `database_tables.xml` |
| **Location** | `D:\ICIS\AuroDev\clogan\AuroDev\MSVC Programs\osub\` |
| **Table Name** | `MHC_ORDER` |
| **Primary Key** | `order_id`, `area`, `item_code` (composite) |
| **Generated By** | `p_ut_makdb` utility |
| **Status** | âœ… Generated - DO NOT MODIFY |

---

## Overview

The `MHC_ORDER` table stores **order information** for outbound shipments. Each order line item (order_id + item_code) has a record tracking required quantities, priority, and fulfillment status.

**Critical Operations:**
- Order creation and tracking
- Case/pallet requirement tracking
- Order status management
- Priority-based order processing

---

## Table Structure

```cpp
typedef struct ordr
{
    // Primary Key Fields
    char    order_id[10+1];              // Order identifier
    char    area[1+1];                   // System area
    char    item_code[5+1];              // Item code (part of primary key)
    
    // Order Information Fields
    long    invoice;                     // Invoice number
    char    order_date[24+1];            // Order date
    long    priority;                    // Order priority
    char    status[32+1];                 // Order status
    
    // Quantity Fields
    long    case_req;                    // Cases required
    long    pal_req;                     // Pallets required
    long    pal_ret_cnt;                 // Pallets returned count
    long    pal_palitize_cnt;            // Pallets palletized count
    long    pal_purge_cnt;               // Pallets purged count
    long    max_case_age;                // Maximum case age (days)
    
    // History Fields
    char    history_func[50+1];          // Function that created history entry
    char    history_comment[256+1];      // History comment text
    long    history_onoff;               // History on/off flag
    
    // Audit Fields
    char    add_date[24+1];              // Date record was added
    char    add_user[132+1];             // User who added record
    char    modify_date[24+1];           // Date record was last modified
    char    modify_user[132+1];          // User who last modified record
    
    // Internal Fields
    char    ORDR_dum[2];                 // Dummy field (alignment)
    _RecordsetPtr    RsP;                // ADO Recordset pointer (internal use)
} ORDR;
```

---

## Primary Key

| Field(s) | Type | Description |
|----------|------|-------------|
| `order_id` | `char[11]` | Order identifier |
| `area` | `char[2]` | System area |
| `item_code` | `char[6]` | Item code |

---

## Generated Functions

### ORDR_select_ORDR_PR_KEY

**Signature:**
```cpp
long ORDR_select_ORDR_PR_KEY(ORDR *sel, GP_BOOL Update);
```

**Description:**
Selects a single ORDR record by primary key (`order_id`, `area`, `item_code`).

**SQL Generated:**
```sql
SELECT * FROM MHC_ORDER WHERE order_id = '{order_id}' AND area = '{area}' AND item_code = '{item_code}'
```

---

### ORDR_select_LOOP

**Signature:**
```cpp
long ORDR_select_LOOP(ORDR *sel, long *count, char *where, GP_BOOL Update, int top = 0);
```

**Description:**
Selects multiple ORDR records using a WHERE clause. Commonly used to get all items for an order.

**Usage Example:**
```cpp
ORDR ordr;
ORDR_init(&ordr);
long count = 0;
char where[256];
sprintf(where, "order_id = 'ORD001' AND area = 'A' ORDER BY item_code");

// Get all items for order
while (ORDR_select_LOOP(&ordr, &count, where, GP_FALSE, 0) == GP.GOOD) {
    cs_log_printf(FILELINE, 3, "Order item: %s, cases_req=%ld, pal_req=%ld", 
                  ordr.item_code, ordr.case_req, ordr.pal_req);
}

count = -1;
ORDR_select_LOOP(&ordr, &count, "", GP_FALSE, 0);
```

---

### ORDR_insert

**Signature:**
```cpp
long ORDR_insert(ORDR *sel, ...);
```

**Description:**
Inserts a new ORDR record.

---

### ORDR_update

**Signature:**
```cpp
long ORDR_update(ORDR *sel);
```

**Description:**
Updates an existing ORDR record. Commonly used to update fulfillment counts.

---

## Related Tables

| Table | Relationship | Foreign Key |
|-------|--------------|-------------|
| `MHC_INVENTORY` | Reference | `MHC_INVENTORY.order_id = MHC_ORDER.order_id` |
| `MHC_PALLET` | Reference | `MHC_PALLET.order_id = MHC_ORDER.order_id` |

---

## Cross-References

| Topic | Document | Section |
|-------|----------|---------|
| Order Processing | [Outbound Workflows](../../05_Workflows/02_Outbound_Processing.md) | Order Fulfillment |
| Pallet Operations | [os_pall.md](os_pall.md) | PALL references ORDR |

---

## Changelog

| Version | Date | Changes |
|---------|------|---------|
| 1.0 | 2024-12-23 | Initial comprehensive documentation |

