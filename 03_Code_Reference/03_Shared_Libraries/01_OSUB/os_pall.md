# os_pall - MHC_PALLET Table Operations

**Document Version:** 1.0  
**Last Updated:** 2024-12-23  
**Author:** CmL  
**Confidence Score:** 0.95

---

## Document Metadata

| Field | Value |
|-------|-------|
| **Source File** | `os_pall.cpp`, `os_pall.h` |
| **Generated From** | `MHC_PALLET` table definition in `database_tables.xml` |
| **Location** | `D:\ICIS\AuroDev\clogan\AuroDev\MSVC Programs\osub\` |
| **Table Name** | `MHC_PALLET` |
| **Primary Key** | `pallet_id`, `area` (composite) |
| **Generated By** | `p_ut_makdb` utility |
| **Status** | âœ… Generated - DO NOT MODIFY |

---

## Overview

The `MHC_PALLET` table stores **pallet configuration and status** for outbound palletization. Each pallet has a record tracking its associated order, item, case count, and status.

**Critical Operations:**
- Pallet creation and tracking
- Pallet status management
- Case count tracking
- Purge flag management

---

## Table Structure

```cpp
typedef struct pall
{
    // Primary Key Fields
    char    pallet_id[10+1];             // Pallet identifier
    char    area[1+1];                   // System area
    
    // Association Fields
    char    order_id[10+1];              // Associated order ID
    char    item_code[5+1];              // Associated item code
    
    // Status Fields
    char    status[32+1];                 // Pallet status
    long    priority;                    // Pallet priority
    long    pallet_config;               // Pallet configuration code
    long    acc_line;                    // Accumulation line
    
    // Quantity Fields
    long    case_cnt;                    // Case count on pallet
    
    // Control Fields
    bool    purge_me;                    // Purge flag
    char    purge_reason[256+1];         // Purge reason
    bool    allow_reallocation;          // Allow reallocation flag
    
    // History Fields
    char    history_func[50+1];          // Function that created history entry
    char    history_comment[256+1];      // History comment text
    long    history_onoff;               // History on/off flag
    
    // Audit Fields
    char    add_date[24+1];              // Date record was added
    char    add_user[132+1];             // User who added record
    char    modify_date[24+1];           // Date record was last modified
    char    modify_user[132+1];          // User who last modified record
    
    // Internal Fields
    char    PALL_dum[1];                  // Dummy field (alignment)
    _RecordsetPtr    RsP;                // ADO Recordset pointer (internal use)
} PALL;
```

---

## Primary Key

| Field(s) | Type | Description |
|----------|------|-------------|
| `pallet_id` | `char[11]` | Pallet identifier |
| `area` | `char[2]` | System area |

---

## Generated Functions

### PALL_select_PALL_PR_KEY

**Signature:**
```cpp
long PALL_select_PALL_PR_KEY(PALL *sel, GP_BOOL Update);
```

**Description:**
Selects a single PALL record by primary key (`pallet_id` and `area`).

**SQL Generated:**
```sql
SELECT * FROM MHC_PALLET WHERE pallet_id = '{pallet_id}' AND area = '{area}'
```

---

### PALL_select_LOOP

**Signature:**
```cpp
long PALL_select_LOOP(PALL *sel, long *count, char *where, GP_BOOL Update, int top = 0);
```

**Description:**
Selects multiple PALL records using a WHERE clause. Commonly used to get all pallets for an order.

**Usage Example:**
```cpp
PALL pall;
PALL_init(&pall);
long count = 0;
char where[256];
sprintf(where, "order_id = 'ORD001' AND area = 'A' AND purge_me = 0");

// Get all active pallets for order
while (PALL_select_LOOP(&pall, &count, where, GP_FALSE, 0) == GP.GOOD) {
    cs_log_printf(FILELINE, 3, "Pallet %s: status=%s, cases=%ld", 
                  pall.pallet_id, pall.status, pall.case_cnt);
}

count = -1;
PALL_select_LOOP(&pall, &count, "", GP_FALSE, 0);
```

---

### PALL_insert

**Signature:**
```cpp
long PALL_insert(PALL *sel, ...);
```

**Description:**
Inserts a new PALL record.

---

### PALL_update

**Signature:**
```cpp
long PALL_update(PALL *sel);
```

**Description:**
Updates an existing PALL record. Commonly used to update case count or status.

---

## Related Tables

| Table | Relationship | Foreign Key |
|-------|--------------|-------------|
| `MHC_ORDER` | Parent | `MHC_PALLET.order_id = MHC_ORDER.order_id` |
| `MHC_INVENTORY` | Reference | `MHC_INVENTORY.pallet_id = MHC_PALLET.pallet_id` |

---

## Cross-References

| Topic | Document | Section |
|-------|----------|---------|
| Order Operations | [os_ordr.md](os_ordr.md) | ORDR references PALL |
| Palletization | [Outbound Workflows](../../05_Workflows/02_Outbound_Processing.md) | Pallet Building |

---

## Changelog

| Version | Date | Changes |
|---------|------|---------|
| 1.0 | 2024-12-23 | Initial comprehensive documentation |

